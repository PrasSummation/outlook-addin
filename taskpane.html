<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>File Email</title>
  <script src="https://appsforoffice.microsoft.com/lib/1.1/hosted/office.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
    }
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }
    .header .branding {
      font-size: 24px;
      font-weight: bold;
      color: #408F4E;
    }
    .header img {
      height: 40px;
    }
    label, input, select, button {
      display: block;
      margin-top: 10px;
      margin-bottom: 10px;
    }
  </style>
</head>
<body>
  <div class="header">
    <div class="branding">File Email</div>
    <img src="https://prassummation.github.io/outlook-addin/logo-symbol-32x32.png" alt="Company Logo" />
  </div>

  <label for="searchBox">Search Project Mailbox:</label>
  <input type="text" id="searchBox" placeholder="Type to search..." />

  <label for="mailboxSelect">Select Mailbox:</label>
  <select id="mailboxSelect" size="10"></select>

  <button onclick="fileEmail()">File to Selected Mailbox</button>

  <script>
    // Dummy data â€“ replace with Graph API call later
    const mailboxList = [
      "Accounting-Projects@summation.au",
      "Legal-Cases@summation.au",
      "IT-Deployments@summation.au",
      "Marketing-Campaigns@summation.au",
      "Engineering-Designs@summation.au",
      "Finance-Forecasts@summation.au",
      "Research-Reports@summation.au",
      "Customer-Support@summation.au",
      "HR-Recruitment@summation.au",
      "Operations-Planning@summation.au",
      "Development-Sprints@summation.au",
      "Procurement@summation.au",
      "QA-Testing@summation.au"
    ];

    const searchBox = document.getElementById("searchBox");
    const mailboxSelect = document.getElementById("mailboxSelect");

    function updateMailboxList(filter) {
      const filtered = mailboxList.filter(m =>
        m.toLowerCase().includes(filter.toLowerCase())
      ).slice(0, 10);

      mailboxSelect.innerHTML = "";
      filtered.forEach(mailbox => {
        const option = document.createElement("option");
        option.value = mailbox;
        option.textContent = mailbox;
        mailboxSelect.appendChild(option);
      });
    }

    searchBox.addEventListener("input", () => {
      updateMailboxList(searchBox.value);
    });

    function fileEmail() {
      const selectedMailbox = mailboxSelect.value;
      if (!selectedMailbox) {
        alert("Please select a mailbox to file the email.");
        return;
      }
      console.log("Would file to:", selectedMailbox);
      alert(`Email would be moved to: ${selectedMailbox}`);
    }

    Office.onReady(() => {
      updateMailboxList("");
      searchBox.focus(); // Auto-focus the search box
    });
  </script>
</body>
</html>



