<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Summation File Email</title>
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    #mailboxList {
      width: 100%;
      height: 150px;
    }
    input, button, select {
      margin-top: 10px;
      width: 100%;
    }
  </style>
</head>
<body>
  <h2>File Email</h2>
  <label for="search">Search Project Mailboxes:</label>
  <input type="text" id="search" placeholder="Type project name...">

  <label for="mailboxList">Select Mailbox:</label>
  <select id="mailboxList" size="10"></select>

  <button id="fileButton">File Email</button>

  <script>
    // Dummy data for mailbox names
    const mailboxes = [
      "Design - Sydney",
      "Design - Melbourne",
      "Engineering - Civil",
      "Engineering - Electrical",
      "Construction - Site A",
      "Construction - Site B",
      "Finance - Projects",
      "Admin - General",
      "Legal - Contracts",
      "Marketing - Campaigns",
      "Research - Development",
      "HR - Recruitment",
      "Support - Helpdesk"
    ];

    const searchInput = document.getElementById("search");
    const mailboxList = document.getElementById("mailboxList");

    function updateMailboxList(filter) {
      const matches = mailboxes.filter(name =>
        name.toLowerCase().includes(filter.toLowerCase())
      ).slice(0, 10); // Limit to top 10 results

      mailboxList.innerHTML = "";
      matches.forEach(name => {
        const option = document.createElement("option");
        option.value = name;
        option.text = name;
        mailboxList.appendChild(option);
      });
    }

    searchInput.addEventListener("input", () => {
      updateMailboxList(searchInput.value);
    });

    document.getElementById("fileButton").addEventListener("click", () => {
      const selectedMailbox = mailboxList.value;
      if (!selectedMailbox) {
        alert("Please select a mailbox.");
        return;
      }
      // Placeholder for actual email moving logic
      alert(`Filing email to: ${selectedMailbox}`);
      // Office.context.mailbox.item.moveAsync(...) or Graph API integration here
    });

    Office.onReady(() => {
      updateMailboxList(""); // Initialize with full list
    });
  </script>
</body>
</html>

